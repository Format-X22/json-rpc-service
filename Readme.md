# CORE-SERVICE 
  
**CORE-SERVICE** является набором корневых классов и утилит для микросервисов [golos.io](https://golos.io).  
Основные возможности:

  - Базовый класс виртуального сервиса, на основе которого строятся все микросервисы.    
  Каждый микросервис содержит в себе 1 или более виртуальных сервисов, работающих асинхронно и скомпанованных в древовидную структуру зависимостей.  
  Базовый класс предлагает общий интерфейс и некоторые утилитные методы для работы, подробнее в описании самого класса.
  
  - Виртуальный сервис для подписки на блоки, генерируемые блокчейном GOLOS.
  
  - Виртуальный сервис восстановления пропущенный блоков на случай если микросервис был перезапущен или произошло что-либо иное подобное.  
  
  - Виртуальный сервис работы с базой данных MongoDB, используя Mongoose.
  
  - Виртуальный сервис связи микросервисов, позволяющий осуществлять двухстороннюю связь между микросервисами через HTTP, используя JSON-RPC, добавляя к этому возможность множественного ответа на единичный запрос JSON-RPC (например для подписки на что-либо).
  
  - Утилиты и обертки для работы со временем, логами и переменными окружения.
  
  - StatsD мониторинг.

Набор `ENV`, которые можно определять для корневых классов:

  - `GLS_GATE_HOST` *(обязательно)* - адрес, который будет использован для входящих подключений связи микросервисов.  
   Дефолтное значение при запуске без докера - `127.0.0.1`

  - `GLS_GATE_PORT` *(обязательно)* - адрес порта, который будет использован для входящих подключений связи микросервисов.  
   Дефолтное значение при запуске без докера - `8080`

  - `GLS_METRICS_HOST` *(обязательно)* - адрес хоста для метрик StatsD.
   Дефолтное значение при запуске без докера - `127.0.0.1`
      
  - `GLS_METRICS_PORT` *(обязательно)* - адрес порта для метрик StatsD.  
   Дефолтное значение при запуске без докера - `8125`

  - `GLS_MONGO_CONNECT` - строка подключения к базе MongoDB.  
   Дефолтное значение - `mongodb://mongo/admin`

  - `GLS_DAY_START` - время начала нового дня в часах относительно UTC, используется для таких вещей как валидация "1 пост в сутки".    
   Дефолтное значение - `3` (день начинается в 00:00 по Москве). 

  - `GLS_BLOCKCHAIN_SUBSCRIBE_TIMEOUT` - таймаут подписки на новые блоки, срабатывает если за это время от блокчейн-ноды не пришло ни единого блока.  
   Дефолтное значение - `60000`, что равно одной минуте.
     
  - `GLS_BLOCKCHAIN_CONNECT` - адрес блокчейн-ноды для прослушивания.  
   Дефолтное значение - `wss://ws.golos.io`
